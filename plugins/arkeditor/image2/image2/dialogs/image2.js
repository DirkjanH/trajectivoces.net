"use strict";
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
CKEDITOR.dialog.add("image2",function(n){function st(){var n=this.getValue().match(tt),t=!!(n&&parseInt(n[1],10)!==0);return t||alert(i.invalidLength.replace("%1",i[this.id]).replace("%2","px")),t}function vt(){function t(t,u){i.push(n.once(t,function(n){r();u(n)}))}function r(){for(var n;n=i.pop();)n.removeListener()}var n=a.createElement("img"),i=[];return function(i,r,u){t("load",function(){var t=ft(n);r.call(u,n,t.width,t.height)});t("error",function(){r(null)});t("abort",function(){r(null)});n.setAttribute("src",(w.baseHref||"")+i+"?"+Math.random().toString(16).substring(2))}}function ht(){var t=this.getValue();p(!1);t!==d.data.src?(ot(t,function(t,i,r){if(p(!0),!t)return l(!1);f.setValue(n.config.image2_prefillDimensions===!1?0:i);e.setValue(n.config.image2_prefillDimensions===!1?0:r);v=o=i;y=s=r;l(ut.checkHasNaturalRatio(t))}),h=!0):h?(p(!0),f.setValue(o),e.setValue(s),h=!1):p(!0)}function ct(){var n;if(r&&(n=this.getValue(),n)&&(n.match(tt)||l(!1),n!=="0")){var t=this.id=="width",i=o||v,u=s||y;n=t?Math.round(u*(n/i)):Math.round(i*(n/u));isNaN(n)||(t?e:f).setValue(n)}}function yt(){function t(n){n.on("mouseover",function(){this.addClass("cke_btn_over")},n);n.on("mouseout",function(){this.removeClass("cke_btn_over")},n)}var n=this.getDialog();if(u=a.getById(it),c=a.getById(rt),u){n.addFocusable(u,4+b);u.on("click",function(n){l();n.data&&n.data.preventDefault()},this.getDialog());t(u)}if(c){n.addFocusable(c,5+b);c.on("click",function(n){h?(f.setValue(v),e.setValue(y)):(f.setValue(o),e.setValue(s));n.data&&n.data.preventDefault()},this);t(c)}}function l(n){var t,i,h;if(u){if(typeof n=="boolean"){if(g)return;r=n}else t=f.getValue(),g=!0,r=!r,r&&t&&(i=s/o*t,isNaN(i)||e.setValue(Math.round(i)));u[r?"removeClass":"addClass"]("cke_btn_unlocked");u.setAttribute("aria-checked",r);CKEDITOR.env.hc&&(h=u.getChild(0),h.setHtml(r?CKEDITOR.env.ie?"■":"▣":CKEDITOR.env.ie?"□":"▢"))}}function p(n){var t=n?"enable":"disable";f[t]();e[t]()}var tt=/(^\s*(\d+)(px)?\s*$)|^$/i,it=CKEDITOR.tools.getNextId(),rt=CKEDITOR.tools.getNextId(),t=n.lang.image2,i=n.lang.common,at=new CKEDITOR.template('<div><a href="javascript:void(0)" tabindex="-1" title="'+t.lockRatio+'" class="cke_btn_locked" id="{lockButtonId}" role="checkbox"><span class="cke_icon"><\/span><span class="cke_label">'+t.lockRatio+'<\/span><\/a><a href="javascript:void(0)" tabindex="-1" title="'+t.resetSize+'" class="cke_btn_reset" id="{resetButtonId}" role="button"><span class="cke_label">'+t.resetSize+"<\/span><\/a><\/div>").output({lockButtonId:it,resetButtonId:rt}),ut=CKEDITOR.plugins.image2,w=n.config,b=!!(w.filebrowserImageBrowseUrl||w.filebrowserBrowseUrl),k=n.widgets.registered.image.features,ft=ut.getNatural,a,d,et,ot,o,s,v,y,h,r,g,u,c,f,e,nt,lt=[{id:"src",type:"text",label:i.url,onKeyup:ht,onChange:ht,setup:function(n){this.setValue(n.data.src)},commit:function(n){n.setData("src",this.getValue())},validate:CKEDITOR.dialog.validate.notEmpty(t.urlMissing)}];return b&&lt.push({type:"button",id:"browse",style:"display:inline-block;margin-top:14px;",align:"center",label:n.lang.common.browseServer,hidden:!0,filebrowser:"info:src"}),{title:t.title,minWidth:250,minHeight:100,onLoad:function(){a=this._.element.getDocument();ot=vt()},onShow:function(){d=this.getModel();et=d.parts.image;h=g=r=!1;nt=ft(et);v=o=nt.width;y=s=nt.height},contents:[{id:"info",label:t.infoTab,elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["100%"],className:"cke_dialog_image_url",children:lt}]},{id:"alt",type:"text",label:t.alt,setup:function(n){this.setValue(n.data.alt)},commit:function(n){n.setData("alt",this.getValue())},validate:n.config.image2_altRequired===!0?CKEDITOR.dialog.validate.notEmpty(t.altMissing):null},{type:"hbox",widths:["25%","25%","50%"],requiredContent:k.dimension.requiredContent,children:[{type:"text",width:"45px",id:"width",label:i.width,validate:st,onKeyUp:ct,onLoad:function(){f=this},setup:function(n){this.setValue(n.data.width)},commit:function(n){n.setData("width",this.getValue())}},{type:"text",id:"height",width:"45px",label:i.height,validate:st,onKeyUp:ct,onLoad:function(){e=this},setup:function(n){this.setValue(n.data.height)},commit:function(n){n.setData("height",this.getValue())}},{id:"lock",type:"html",style:"margin-top:18px;width:40px;height:20px;",onLoad:yt,setup:function(n){l(n.data.lock)},commit:function(n){n.setData("lock",r)},html:at}]},{type:"hbox",id:"alignment",requiredContent:k.align.requiredContent,children:[{id:"align",type:"radio",items:[[i.alignNone,"none"],[i.left,"left"],[i.center,"center"],[i.right,"right"]],label:i.align,setup:function(n){this.setValue(n.data.align)},commit:function(n){n.setData("align",this.getValue())}}]},{id:"hasCaption",type:"checkbox",label:t.captioned,requiredContent:k.caption.requiredContent,setup:function(n){this.setValue(n.data.hasCaption)},commit:function(n){n.setData("hasCaption",this.getValue())}}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:t.uploadTab,elements:[{type:"file",id:"upload",label:t.btnUpload,style:"height:40px"},{type:"fileButton",id:"uploadButton",filebrowser:"info:src",label:t.btnUpload,"for":["Upload","upload"]}]}]}})