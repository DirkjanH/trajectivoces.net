/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
(function(){function i(n){return CKEDITOR.env.ie?n.$.clientWidth:parseInt(n.getComputedStyle("width"),10)}function t(n,t){var i=n.getComputedStyle("border-"+t+"-width"),r={thin:"0px",medium:"1px",thick:"2px"};return i.indexOf("px")<0&&(i=i in r&&n.getComputedStyle("border-style")!="none"?r[i]:0),parseFloat(i)}function o(n){if(n){var t=new CKEDITOR.dom.element(n);return{height:t.$.offsetHeight,position:t.getDocumentPosition()}}}function s(n){var u=[],i={},r=n.getComputedStyle("direction")==="rtl",f=CKEDITOR.tools.array.zip(new CKEDITOR.dom.nodeList(n.$.rows).toArray(),CKEDITOR.tools.buildTableMap(n));return CKEDITOR.tools.array.forEach(f,function(f){var g=f[0].$,y=f[1],h=-1,b=0,k=null,d=o(g),nt=CKEDITOR.env.ie&&!CKEDITOR.env.edge,tt=n.getComputedStyle("border-collapse")==="collapse",c;for(b=d.height,k=d.position,c=0;c<y.length;c++){var l=new CKEDITOR.dom.element(y[c]),a=y[c+1]&&new CKEDITOR.dom.element(y[c+1]),p,s,v,w,e=l.getDocumentPosition().x;h+=l.$.colSpan||1;r?v=e+t(l,"left"):s=e+l.$.offsetWidth-t(l,"right");a?(e=a.getDocumentPosition().x,r?s=e+a.$.offsetWidth-t(a,"right"):v=e+t(a,"left")):(e=n.getDocumentPosition().x,r?s=e:v=e+n.$.offsetWidth);w=Math.max(v-s,3);nt&&tt&&(s-=w,w=Math.max(v-s,3));p={table:n,index:h,x:s,y:k.y,width:w,height:b,rtl:r};i[h]=i[h]||[];i[h].push(p);p.alignedPillars=i[h];u.push(p)}}),u}function f(n,t,i){return n>=i.x&&n<=i.x+i.width&&t>=i.y&&t<=i.y+i.height}function h(n,t){for(var r,i=0,u=n.length;i<u;i++)if(r=n[i],f(t.x,t.y,r))return r;return null}function u(n){(n.data||n).preventDefault()}function c(e){function nt(){s=null;l=0;c=0;h.removeListener("mouseup",d);o.removeListener("mousedown",k);o.removeListener("mousemove",g);h.getBody().setStyle("cursor","auto");r?o.remove():o.hide()}function tt(){for(var b=s.index,k=CKEDITOR.tools.buildTableMap(s.table),d=[],nt=[],r=Number.MAX_VALUE,f=r,tt=s.rtl,e=0,rt=k.length;e<rt;e++){var it=k[e],n=it[b+(tt?1:0)],t=it[b+(tt?0:1)];n=n&&new CKEDITOR.dom.element(n);t=t&&new CKEDITOR.dom.element(t);n&&t&&n.equals(t)||(n&&(r=Math.min(r,i(n))),t&&(f=Math.min(f,i(t))),d.push(n),nt.push(t))}a=d;v=nt;y=s.x-r;p=s.x+f;o.setOpacity(.5);w=parseInt(o.getStyle("left"),10);l=0;c=1;o.on("mousemove",g);h.on("dragstart",u)}function it(){c=0;o.setOpacity(0);l&&rt();var n=s.table;setTimeout(function(){n.removeCustomData("_cke_table_pillars")},0);h.removeListener("dragstart",u)}function rt(){for(var h=s.rtl,c=h?v.length:a.length,y=0,r=0;r<c;r++){var u=a[r],f=v[r],o=s.table;CKEDITOR.tools.setTimeout(function(t,i,r,u,f,s){t&&t.setStyle("width",n(Math.max(i+s,1)));r&&r.setStyle("width",n(Math.max(u-s,1)));f&&o.setStyle("width",n(f+s*(h?-1:1)));++y==c&&e.fire("saveSnapshot")},0,this,[u,u&&i(u),f,f&&i(f),(!u||!f)&&i(o)+t(o,"left")+t(o,"right"),l])}}function k(n){u(n);e.fire("saveSnapshot");tt();h.on("mouseup",d,this)}function d(n){n.removeListener();it()}function g(n){b(n.data.getPageOffset().x)}var s,h,o,c,w,l,b,a,v,y,p;h=e.document;o=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10000"><\/div>',h);e.on("destroy",function(){o.remove()});r||h.getDocumentElement().append(o);this.attachTo=function(t){var i,u,f,e;if(!c){r&&(h.getBody().append(o),l=0);s=t;i=s.alignedPillars[0];u=s.alignedPillars[s.alignedPillars.length-1];e=i.y;f=u.height+u.y-i.y;o.setStyles({width:n(t.width),height:n(f),left:n(t.x),top:n(e)});r&&o.setOpacity(.25);o.on("mousedown",k,this);h.getBody().setStyle("cursor","col-resize");o.show()}};b=this.move=function(t,i){if(!s)return 0;if(!c&&!f(t,i,s))return nt(),0;var r=t-Math.round(o.$.offsetWidth/2);if(c){if(r==y||r==p)return 1;r=Math.max(r,y);r=Math.min(r,p);l=r-w}return o.setStyle("left",n(r)),1}}function e(n){var i=n.data.getTarget(),t;if(n.name=="mouseout"){if(!i.is("table"))return;for(t=new CKEDITOR.dom.element(n.data.$.relatedTarget||n.data.$.toElement);t&&t.$&&!t.equals(i)&&!t.is("body");)t=t.getParent();if(!t||t.equals(i))return}i.getAscendant("table",1).removeCustomData("_cke_table_pillars");n.removeListener()}var n=CKEDITOR.tools.cssLength,r=CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks);CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(n){n.on("contentDom",function(){var t,i=n.editable();i.attachListener(i.isInline()?i:n.document,"mousemove",function(i){var f,o,r,l,a;if(i=i.data,f=i.getTarget(),f.type==CKEDITOR.NODE_ELEMENT){if(o={x:i.getPageOffset().x,y:i.getPageOffset().y},t&&t.move(o.x,o.y)){u(i);return}if((f.is("table")||f.getAscendant({thead:1,tbody:1,tfoot:1},1))&&(r=f.getAscendant("table",1),n.editable().contains(r))){if(!(l=r.getCustomData("_cke_table_pillars"))){r.setCustomData("_cke_table_pillars",l=s(r));r.on("mouseout",e);r.on("mousedown",e)}a=h(l,o);a&&(t||(t=new c(n)),t.attachTo(a))}}})})}})})()